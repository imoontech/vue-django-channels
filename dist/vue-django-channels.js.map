{"version":3,"sources":["webpack:///webpack/bootstrap 1597307d271c0bece0d9","webpack:///./~/django-channels/lib/index.js","webpack:///./src/index.js","webpack:///./~/reconnecting-websocket/dist/index.js"],"names":["install","Vue","url","protocols","options","webSocketBridge","connect","listen","prototype","$channels","$socket","socket","addListeners","$options","conf","channels","events","prefix","Object","keys","forEach","key","func","bind","addEventListener","__binded","removeListeners","removeEventListener","addStreamHandlers","streams","stream","demultiplex","mixin","beforeCompile","beforeCreate","created","beforeDestroy"],"mappings":";;;;;;;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,mDAA2C,cAAc;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;AChEA;;AAEA;AACA;AACA,CAAC;AACD;;AAEA,mDAAmD,gBAAgB,sBAAsB,OAAO,2BAA2B,0BAA0B,yDAAyD,2BAA2B,EAAE,EAAE,EAAE,eAAe;;AAE9P,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE;;AAEjjB;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA,8BAA8B;AAC9B;;AAEA;AACA;AACA;AACA,kBAAkB,OAAO;AACzB;AACA,kBAAkB,gBAAgB;AAClC,kBAAkB,OAAO;AACzB;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oBAAoB,SAAS;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;;AAEA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;;AAE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AACA,SAAS;AACT,KAAK;AACL;AACA,gDAAgD,wBAAwB,EAAE;AAC1E;AACA;AACA;AACA;AACA,6BAA6B,cAAc;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,oCAAoC,EAAE;AACtE,iCAAiC,mCAAmC,EAAE;AACtE;AACA;AACA;AACA;AACA;AACA,wBAAwB,uBAAuB;AAC/C;AACA;AACA;AACA,KAAK,gBAAgB;AACrB;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,KAAK,KAAK;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,aAAa;AAC3C,gCAAgC,aAAa;AAC7C,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA","file":"vue-django-channels.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 1597307d271c0bece0d9","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.WebSocketBridge = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _reconnectingWebsocket = require('reconnecting-websocket');\n\nvar _reconnectingWebsocket2 = _interopRequireDefault(_reconnectingWebsocket);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Bridge between Channels and plain javascript.\n *\n * @example\n * const webSocketBridge = new WebSocketBridge();\n * webSocketBridge.connect();\n * webSocketBridge.listen(function(action, stream) {\n *   console.log(action, stream);\n * });\n */\nvar WebSocketBridge = function () {\n  function WebSocketBridge(options) {\n    _classCallCheck(this, WebSocketBridge);\n\n    /**\n     * The underlaying `ReconnectingWebSocket` instance.\n     * \n     * @type {ReconnectingWebSocket}\n     */\n    this.socket = null;\n    this.streams = {};\n    this.default_cb = null;\n    this.options = _extends({}, options);\n  }\n\n  /**\n   * Connect to the websocket server\n   *\n   * @param      {String}  [url]     The url of the websocket. Defaults to\n   * `window.location.host`\n   * @param      {String[]|String}  [protocols] Optional string or array of protocols.\n   * @param      {Object} options Object of options for [`reconnecting-websocket`](https://github.com/joewalnes/reconnecting-websocket#options-1).\n   * @example\n   * const webSocketBridge = new WebSocketBridge();\n   * webSocketBridge.connect();\n   */\n\n\n  _createClass(WebSocketBridge, [{\n    key: 'connect',\n    value: function connect(url, protocols, options) {\n      var _url = void 0;\n      // Use wss:// if running on https://\n      var scheme = window.location.protocol === 'https:' ? 'wss' : 'ws';\n      var base_url = scheme + '://' + window.location.host;\n      if (url === undefined) {\n        _url = base_url;\n      } else {\n        // Support relative URLs\n        if (url[0] == '/') {\n          _url = '' + base_url + url;\n        } else {\n          _url = url;\n        }\n      }\n      this.socket = new _reconnectingWebsocket2.default(_url, protocols, options);\n    }\n\n    /**\n     * Starts listening for messages on the websocket, demultiplexing if necessary.\n     *\n     * @param      {Function}  [cb]         Callback to be execute when a message\n     * arrives. The callback will receive `action` and `stream` parameters\n     *\n     * @example\n     * const webSocketBridge = new WebSocketBridge();\n     * webSocketBridge.connect();\n     * webSocketBridge.listen(function(action, stream) {\n     *   console.log(action, stream);\n     * });\n     */\n\n  }, {\n    key: 'listen',\n    value: function listen(cb) {\n      var _this = this;\n\n      this.default_cb = cb;\n      this.socket.onmessage = function (event) {\n        var msg = JSON.parse(event.data);\n        var action = void 0;\n        var stream = void 0;\n\n        if (msg.stream !== undefined) {\n          action = msg.payload;\n          stream = msg.stream;\n          var stream_cb = _this.streams[stream];\n          stream_cb ? stream_cb(action, stream) : null;\n        } else {\n          action = msg;\n          stream = null;\n          _this.default_cb ? _this.default_cb(action, stream) : null;\n        }\n      };\n    }\n\n    /**\n     * Adds a 'stream handler' callback. Messages coming from the specified stream\n     * will call the specified callback.\n     *\n     * @param      {String}    stream  The stream name\n     * @param      {Function}  cb      Callback to be execute when a message\n     * arrives. The callback will receive `action` and `stream` parameters.\n      * @example\n     * const webSocketBridge = new WebSocketBridge();\n     * webSocketBridge.connect();\n     * webSocketBridge.listen();\n     * webSocketBridge.demultiplex('mystream', function(action, stream) {\n     *   console.log(action, stream);\n     * });\n     * webSocketBridge.demultiplex('myotherstream', function(action, stream) {\n     *   console.info(action, stream);\n     * });\n     */\n\n  }, {\n    key: 'demultiplex',\n    value: function demultiplex(stream, cb) {\n      this.streams[stream] = cb;\n    }\n\n    /**\n     * Sends a message to the reply channel.\n     *\n     * @param      {Object}  msg     The message\n     *\n     * @example\n     * webSocketBridge.send({prop1: 'value1', prop2: 'value1'});\n     */\n\n  }, {\n    key: 'send',\n    value: function send(msg) {\n      this.socket.send(JSON.stringify(msg));\n    }\n\n    /**\n     * Returns an object to send messages to a specific stream\n     *\n     * @param      {String}  stream  The stream name\n     * @return     {Object}  convenience object to send messages to `stream`.\n     * @example\n     * webSocketBridge.stream('mystream').send({prop1: 'value1', prop2: 'value1'})\n     */\n\n  }, {\n    key: 'stream',\n    value: function stream(_stream) {\n      var _this2 = this;\n\n      return {\n        send: function send(action) {\n          var msg = {\n            stream: _stream,\n            payload: action\n          };\n          _this2.socket.send(JSON.stringify(msg));\n        }\n      };\n    }\n  }]);\n\n  return WebSocketBridge;\n}();\n\nexports.WebSocketBridge = WebSocketBridge;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/django-channels/lib/index.js\n// module id = 0\n// module chunks = 0","// based on [vue-websocket](https://github.com/icebob/vue-websocket)\r\n\r\nimport { WebSocketBridge } from 'django-channels';\r\n\r\nexport default {\r\n\r\n    install(Vue, url, protocols, options) {\r\n\r\n        let webSocketBridge = new WebSocketBridge()\r\n\r\n        webSocketBridge.connect(url, protocols, options);\r\n        webSocketBridge.listen();\r\n\r\n        Vue.prototype.$channels = webSocketBridge;\r\n        Vue.prototype.$socket = webSocketBridge.socket;\r\n\r\n        let addListeners = function () {\r\n            if (this.$options[\"channels\"]) {\r\n                let conf = this.$options.channels;\r\n\r\n                if (conf.events) {\r\n                    let prefix = conf.prefix || \"\";\r\n                    Object.keys(conf.events).forEach((key) => {\r\n                        let func = conf.events[key].bind(this);\r\n                        this.$socket.addEventListener(prefix + key, func);\r\n                        conf.events[key].__binded = func;\r\n                    });\r\n                }\r\n            }\r\n        };\r\n\r\n        let removeListeners = function () {\r\n            if (this.$options[\"channels\"]) {\r\n                let conf = this.$options.channels;\r\n\r\n                if (conf.events) {\r\n                    let prefix = conf.prefix || \"\";\r\n                    Object.keys(conf.events).forEach((key) => {\r\n                        this.$socket.removeEventListener(prefix + key, conf.events[key].__binded);\r\n                    });\r\n                }\r\n            }\r\n        };\r\n\r\n        let addStreamHandlers = function () {\r\n            if (this.$options[\"channels\"]) {\r\n                let conf = this.$options.channels;\r\n\r\n                if (conf.streams) {\r\n                    Object.keys(conf.streams).forEach((stream) => {\r\n                        let func = conf.streams[stream].bind(this);\r\n                        this.$channels.demultiplex(stream, func);\r\n                    });\r\n                }\r\n            }\r\n        };\r\n\r\n        Vue.mixin({\r\n            // Vue v1.x\r\n            beforeCompile: addListeners,\r\n            // Vue v2.x\r\n            beforeCreate: addListeners,\r\n\r\n            created: addStreamHandlers,\r\n\r\n            beforeDestroy: removeListeners\r\n        });\r\n    }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","\"use strict\";\nvar isWebSocket = function (constructor) {\n    return constructor && constructor.CLOSING === 2;\n};\nvar isGlobalWebSocket = function () {\n    return typeof WebSocket !== 'undefined' && isWebSocket(WebSocket);\n};\nvar getDefaultOptions = function () { return ({\n    constructor: isGlobalWebSocket() ? WebSocket : null,\n    maxReconnectionDelay: 10000,\n    minReconnectionDelay: 1500,\n    reconnectionDelayGrowFactor: 1.3,\n    connectionTimeout: 4000,\n    maxRetries: Infinity,\n    debug: false,\n}); };\nvar bypassProperty = function (src, dst, name) {\n    Object.defineProperty(dst, name, {\n        get: function () { return src[name]; },\n        set: function (value) { src[name] = value; },\n        enumerable: true,\n        configurable: true,\n    });\n};\nvar initReconnectionDelay = function (config) {\n    return (config.minReconnectionDelay + Math.random() * config.minReconnectionDelay);\n};\nvar updateReconnectionDelay = function (config, previousDelay) {\n    var newDelay = previousDelay * config.reconnectionDelayGrowFactor;\n    return (newDelay > config.maxReconnectionDelay)\n        ? config.maxReconnectionDelay\n        : newDelay;\n};\nvar LEVEL_0_EVENTS = ['onopen', 'onclose', 'onmessage', 'onerror'];\nvar reassignEventListeners = function (ws, oldWs, listeners) {\n    Object.keys(listeners).forEach(function (type) {\n        listeners[type].forEach(function (_a) {\n            var listener = _a[0], options = _a[1];\n            ws.addEventListener(type, listener, options);\n        });\n    });\n    if (oldWs) {\n        LEVEL_0_EVENTS.forEach(function (name) { ws[name] = oldWs[name]; });\n    }\n};\nvar ReconnectingWebsocket = function (url, protocols, options) {\n    var _this = this;\n    if (options === void 0) { options = {}; }\n    var ws;\n    var connectingTimeout;\n    var reconnectDelay = 0;\n    var retriesCount = 0;\n    var shouldRetry = true;\n    var savedOnClose = null;\n    var listeners = {};\n    // require new to construct\n    if (!(this instanceof ReconnectingWebsocket)) {\n        throw new TypeError(\"Failed to construct 'ReconnectingWebSocket': Please use the 'new' operator\");\n    }\n    // Set config. Not using `Object.assign` because of IE11\n    var config = getDefaultOptions();\n    Object.keys(config)\n        .filter(function (key) { return options.hasOwnProperty(key); })\n        .forEach(function (key) { return config[key] = options[key]; });\n    if (!isWebSocket(config.constructor)) {\n        throw new TypeError('Invalid WebSocket constructor. Set `options.constructor`');\n    }\n    var log = config.debug ? function () {\n        var params = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            params[_i - 0] = arguments[_i];\n        }\n        return console.log.apply(console, ['RWS:'].concat(params));\n    } : function () { };\n    /**\n     * Not using dispatchEvent, otherwise we must use a DOM Event object\n     * Deferred because we want to handle the close event before this\n     */\n    var emitError = function (code, msg) { return setTimeout(function () {\n        var err = new Error(msg);\n        err.code = code;\n        if (Array.isArray(listeners.error)) {\n            listeners.error.forEach(function (_a) {\n                var fn = _a[0];\n                return fn(err);\n            });\n        }\n        if (ws.onerror) {\n            ws.onerror(err);\n        }\n    }, 0); };\n    var handleClose = function () {\n        log('close');\n        retriesCount++;\n        log('retries count:', retriesCount);\n        if (retriesCount > config.maxRetries) {\n            emitError('EHOSTDOWN', 'Too many failed connection attempts');\n            return;\n        }\n        if (!reconnectDelay) {\n            reconnectDelay = initReconnectionDelay(config);\n        }\n        else {\n            reconnectDelay = updateReconnectionDelay(config, reconnectDelay);\n        }\n        log('reconnectDelay:', reconnectDelay);\n        if (shouldRetry) {\n            setTimeout(connect, reconnectDelay);\n        }\n    };\n    var connect = function () {\n        log('connect');\n        var oldWs = ws;\n        ws = new config.constructor(url, protocols);\n        connectingTimeout = setTimeout(function () {\n            log('timeout');\n            ws.close();\n            emitError('ETIMEDOUT', 'Connection timeout');\n        }, config.connectionTimeout);\n        log('bypass properties');\n        for (var key in ws) {\n            // @todo move to constant\n            if (['addEventListener', 'removeEventListener', 'close', 'send'].indexOf(key) < 0) {\n                bypassProperty(ws, _this, key);\n            }\n        }\n        ws.addEventListener('open', function () {\n            clearTimeout(connectingTimeout);\n            log('open');\n            reconnectDelay = initReconnectionDelay(config);\n            log('reconnectDelay:', reconnectDelay);\n            retriesCount = 0;\n        });\n        ws.addEventListener('close', handleClose);\n        reassignEventListeners(ws, oldWs, listeners);\n        // because when closing with fastClose=true, it is saved and set to null to avoid double calls\n        ws.onclose = ws.onclose || savedOnClose;\n        savedOnClose = null;\n    };\n    log('init');\n    connect();\n    this.close = function (code, reason, _a) {\n        if (code === void 0) { code = 1000; }\n        if (reason === void 0) { reason = ''; }\n        var _b = _a === void 0 ? {} : _a, _c = _b.keepClosed, keepClosed = _c === void 0 ? false : _c, _d = _b.fastClose, fastClose = _d === void 0 ? true : _d, _e = _b.delay, delay = _e === void 0 ? 0 : _e;\n        if (delay) {\n            reconnectDelay = delay;\n        }\n        shouldRetry = !keepClosed;\n        ws.close(code, reason);\n        if (fastClose) {\n            var fakeCloseEvent_1 = {\n                code: code,\n                reason: reason,\n                wasClean: true,\n            };\n            // execute close listeners soon with a fake closeEvent\n            // and remove them from the WS instance so they\n            // don't get fired on the real close.\n            handleClose();\n            ws.removeEventListener('close', handleClose);\n            // run and remove level2\n            if (Array.isArray(listeners.close)) {\n                listeners.close.forEach(function (_a) {\n                    var listener = _a[0], options = _a[1];\n                    listener(fakeCloseEvent_1);\n                    ws.removeEventListener('close', listener, options);\n                });\n            }\n            // run and remove level0\n            if (ws.onclose) {\n                savedOnClose = ws.onclose;\n                ws.onclose(fakeCloseEvent_1);\n                ws.onclose = null;\n            }\n        }\n    };\n    this.send = function (data) {\n        ws.send(data);\n    };\n    this.addEventListener = function (type, listener, options) {\n        if (Array.isArray(listeners[type])) {\n            if (!listeners[type].some(function (_a) {\n                var l = _a[0];\n                return l === listener;\n            })) {\n                listeners[type].push([listener, options]);\n            }\n        }\n        else {\n            listeners[type] = [[listener, options]];\n        }\n        ws.addEventListener(type, listener, options);\n    };\n    this.removeEventListener = function (type, listener, options) {\n        if (Array.isArray(listeners[type])) {\n            listeners[type] = listeners[type].filter(function (_a) {\n                var l = _a[0];\n                return l !== listener;\n            });\n        }\n        ws.removeEventListener(type, listener, options);\n    };\n};\nmodule.exports = ReconnectingWebsocket;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/reconnecting-websocket/dist/index.js\n// module id = 2\n// module chunks = 0"],"sourceRoot":""}