/**
 * vue-django-channels v0.2.0
 * https://github.com/imoontech/vue-django-channels
 * Released under the MIT License.
 */

!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.VueDjangoChannels=n():e.VueDjangoChannels=n()}(this,function(){return function(e){function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}var t={};return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="/dist/",n(n.s=1)}([function(e,n,t){"use strict";function o(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var r=t(2),i=t.n(r);t.d(n,"a",function(){return a});var s=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},c=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}(),a=function(){function e(n){o(this,e),this.socket=null,this.streams={},this.default_cb=null,this.options=s({},n)}return c(e,[{key:"connect",value:function(e,n,t){var o=void 0,r="https:"===window.location.protocol?"wss":"ws",s=r+"://"+window.location.host;o=void 0===e?s:"/"==e[0]?""+s+e:e,this.socket=new i.a(o,n,t)}},{key:"listen",value:function(e){var n=this;this.default_cb=e,this.socket.onmessage=function(e){var t=JSON.parse(e.data),o=void 0,r=void 0;void 0!==t.stream?(o=t.payload,r=t.stream,Array.isArray(n.streams[r])&&n.streams[r].forEach(function(e){e&&e(o,r)})):(o=t,r=null,n.default_cb&&n.default_cb(o,r))}}},{key:"demultiplex",value:function(e,n){Array.isArray(this.streams[e])?this.streams[e].push(n):this.streams[e]=[n]}},{key:"removeStreamHandler",value:function(e,n){Array.isArray(this.streams[e])&&(this.streams[e]=this.streams[e].filter(function(e){return e!==n}),0===this.streams[e].length&&delete this.streams[e])}},{key:"send",value:function(e){this.socket.send(JSON.stringify(e))}},{key:"stream",value:function(e){var n=this;return{send:function(t){var o={stream:e,payload:t};n.socket.send(JSON.stringify(o))}}}}]),e}()},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=t(0),r={install:function(e,n,t,r){var i=new o.a;i.connect(n,t,r),i.listen(),e.prototype.$channels=i;var s=function(){var e=this;if(this.$options.channels){var n=this.$options.channels;if(n.events){var t=n.prefix||"";Object.keys(n.events).forEach(function(o){var r=n.events[o].bind(e);e.$channels.socket.addEventListener(t+o,r),n.events[o].__binded=r})}}},c=function(){var e=this;if(this.$options.channels){var n=this.$options.channels;if(n.events){var t=n.prefix||"";Object.keys(n.events).forEach(function(o){e.$channels.socket.removeEventListener(t+o,n.events[o].__binded)})}}},a=function(){var e=this;if(this.$options.channels){var n=this.$options.channels;n.streams&&Object.keys(n.streams).forEach(function(t){var o=n.streams[t].bind(e);e.$channels.demultiplex(t,o)})}},u=function(){var e=this;if(this.$options.channels){var n=this.$options.channels;n.streams&&Object.keys(n.streams).forEach(function(t){e.$channels.removeStreamHandler(t,n.streams[t].__binded)})}},f=function(){c(),u()};e.mixin({beforeCompile:s,beforeCreate:s,created:a,beforeDestroy:f})}};n.default=r},function(e,n,t){"use strict";var o=function(e){return e&&2===e.CLOSING},r=function(){return"undefined"!=typeof WebSocket&&o(WebSocket)},i=function(){return{constructor:r()?WebSocket:null,maxReconnectionDelay:1e4,minReconnectionDelay:1500,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:1/0,debug:!1}},s=function(e,n,t){Object.defineProperty(n,t,{get:function(){return e[t]},set:function(n){e[t]=n},enumerable:!0,configurable:!0})},c=function(e){return e.minReconnectionDelay+Math.random()*e.minReconnectionDelay},a=function(e,n){var t=n*e.reconnectionDelayGrowFactor;return t>e.maxReconnectionDelay?e.maxReconnectionDelay:t},u=["onopen","onclose","onmessage","onerror"],f=function(e,n,t){Object.keys(t).forEach(function(n){t[n].forEach(function(t){var o=t[0],r=t[1];e.addEventListener(n,o,r)})}),n&&u.forEach(function(t){e[t]=n[t]})},l=function(e,n,t){var r=this;void 0===t&&(t={});var u,v,d=0,h=0,p=!0,m=null,y={};if(!(this instanceof l))throw new TypeError("Failed to construct 'ReconnectingWebSocket': Please use the 'new' operator");var b=i();if(Object.keys(b).filter(function(e){return t.hasOwnProperty(e)}).forEach(function(e){return b[e]=t[e]}),!o(b.constructor))throw new TypeError("Invalid WebSocket constructor. Set `options.constructor`");var E=b.debug?function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];return console.log.apply(console,["RWS:"].concat(e))}:function(){},k=function(e,n){return setTimeout(function(){var t=new Error(n);t.code=e,Array.isArray(y.error)&&y.error.forEach(function(e){return(0,e[0])(t)}),u.onerror&&u.onerror(t)},0)},w=function(){if(E("close"),h++,E("retries count:",h),h>b.maxRetries)return void k("EHOSTDOWN","Too many failed connection attempts");d=d?a(b,d):c(b),E("reconnectDelay:",d),p&&setTimeout(O,d)},O=function(){E("connect");var t=u;u=new b.constructor(e,n),v=setTimeout(function(){E("timeout"),u.close(),k("ETIMEDOUT","Connection timeout")},b.connectionTimeout),E("bypass properties");for(var o in u)["addEventListener","removeEventListener","close","send"].indexOf(o)<0&&s(u,r,o);u.addEventListener("open",function(){clearTimeout(v),E("open"),d=c(b),E("reconnectDelay:",d),h=0}),u.addEventListener("close",w),f(u,t,y),u.onclose=u.onclose||m,m=null};E("init"),O(),this.close=function(e,n,t){void 0===e&&(e=1e3),void 0===n&&(n="");var o=void 0===t?{}:t,r=o.keepClosed,i=void 0!==r&&r,s=o.fastClose,c=void 0===s||s,a=o.delay,f=void 0===a?0:a;if(f&&(d=f),p=!i,u.close(e,n),c){var l={code:e,reason:n,wasClean:!0};w(),u.removeEventListener("close",w),Array.isArray(y.close)&&y.close.forEach(function(e){var n=e[0],t=e[1];n(l),u.removeEventListener("close",n,t)}),u.onclose&&(m=u.onclose,u.onclose(l),u.onclose=null)}},this.send=function(e){u.send(e)},this.addEventListener=function(e,n,t){Array.isArray(y[e])?y[e].some(function(e){return e[0]===n})||y[e].push([n,t]):y[e]=[[n,t]],u.addEventListener(e,n,t)},this.removeEventListener=function(e,n,t){Array.isArray(y[e])&&(y[e]=y[e].filter(function(e){return e[0]!==n})),u.removeEventListener(e,n,t)}};e.exports=l}])});
//# sourceMappingURL=vue-django-channels.js.map